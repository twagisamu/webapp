<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>WebApp Demo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; max-width: 720px; margin: 2rem auto; padding: 0 1rem; }
      header { display:flex; align-items:center; gap:.5rem; }
      code, pre { background:#f3f3f3; padding:.2rem .4rem; border-radius:6px; }
      .items { margin-top: 1rem; }
      input { padding:.5rem; }
      button { padding:.5rem .75rem; }
      .health { font-size: .9rem; color: #555; }
    </style>
  </head>
  <body>
    <header>
      <h1>WebApp Demo</h1>
      <span class="health" id="health"></span>
    </header>
    <p>This is the running example used across the DevOps ToT. Add items, view them, and use it to practice CI/CD, containers, K8s, AWS, and security.</p>

    <div>
      <input id="text" placeholder="Add an item..." />
      <button onclick="add()">Add</button>
    </div>
    <div class="items" id="items"></div>

    <script>
      async function loadHealth() {
        const res = await fetch('/health'); const d = await res.json();
        document.getElementById('health').textContent = d.ok ? 'healthy' : 'unhealthy';
      }
      async function list() {
        const res = await fetch('/api/items'); const data = await res.json();
        document.getElementById('items').innerHTML = '<ul>' + data.map(i=>'<li>'+i.text+'</li>').join('') + '</ul>';
      }
      async function add() {
        const text = document.getElementById('text').value.trim();
        if(!text) return;
        await fetch('/api/items', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({text}) });
        document.getElementById('text').value = '';
        list();
      }
      loadHealth(); list();
    </script>
  </body>
</html>
